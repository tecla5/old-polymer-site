<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<script src="../bower_components/page/page.js"></script>
<script>
window.addEventListener('WebComponentsReady', function() {
  console.log('WebComponentsReady-routing');
  // We use Page.js for routing. This is a Micro
  // client-side router inspired by the Express router
  // More info: https://visionmedia.github.io/page.js/

  // Removes end / from app.baseUrl which page.base requires for production
  if (window.location.port === '') {
    // if production
    page.base(app.baseUrl.replace(/\/$/, ''));
  }

  // Middleware
  function scrollToTop(ctx, next) {
    //app.scrollPageToTop();
    next();
  }

  page('/:lang(es|en)', function(data) {
    console.log('/lang', window.location.pathname);
    window.I18nMsg.lang = data.params.lang;
    page.redirect('/');
  });

  page('/', scrollToTop, function() {
    console.log('/home', window.location.pathname, window.I18nMsg.lang);
    window.I18nMsg.lang = window.I18nMsg.lang || document.documentElement.lang || 'en';
    console.log(window.I18nMsg.lang);

    if (app.route === undefined) {
      app.route = 'splash';
    }
  });

  page('/splash', scrollToTop, function() {
    app.route = 'splash';
  });

  page('/home', scrollToTop, function() {
    app.route = 'home';
  });

  page('/services', scrollToTop, function() {
    app.route = 'services';
  });

  page('/about', scrollToTop, function() {
    app.route = 'about';
  });

  page('/team', scrollToTop, function() {
    app.route = 'team';
  });

  page('/contact', scrollToTop, function() {
    app.route = 'contact';
  });

  page('/blog', scrollToTop, function() {
    app.route = 'blog';
  });

  page('/portfolio', scrollToTop, function() {
    app.route = 'portfolio';
  });

  // portfolio
  page('/finished', function() {
    app.route = 'finished';
  });

  page('/inprogress', function() {
    app.route = 'showcase';
  });

  page('/videos', function() {
    app.route = 'videos';
  });

  page('/showcase', function() {
    app.route = 'showcase';
  });

  /*
  page('/users/:name', scrollToTop, (data) => {
    app.route = 'user-info';
    app.params = data.params;
  });
  */

  page('*', function() {
    app.$.toast.text = 'Can\'t find: ' + window.location.href + '. Redirected you to Home Page';
    app.$.toast.show();
    page.redirect(app.baseUrl);
  });

  // add #! before urls
  page({
    hashbang: false
  });

});
</script>
